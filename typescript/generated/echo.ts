// @generated by roam-codegen
// DO NOT EDIT - regenerate with `cargo xtask codegen --typescript`

import type { MethodHandler } from "../src/index.ts";
import { encodeResultOk, encodeResultErr, encodeInvalidPayload } from "../src/index.ts";
import { encodeString, decodeString } from "../src/index.ts";

export const METHOD_ID = {
  echo: 0x3d66dd9ee36b4240n,
  reverse: 0x268246d3219503fbn,
} as const;

// Type definitions
export type EchoRequest = [string];
export type EchoResponse = string;

export type ReverseRequest = [string];
export type ReverseResponse = string;

// Client interface for Echo
export interface EchoClient {
  /**  Echoes the message back. */
  echo(message: string): Promise<string>;
  /**  Returns the message reversed. */
  reverse(message: string): Promise<string>;
}

// Server handler interface for Echo
export interface EchoHandler {
  echo(message: string): Promise<string> | string;
  reverse(message: string): Promise<string> | string;
}

// Method handlers for Echo
export const echo_methodHandlers = new Map<bigint, MethodHandler<EchoHandler>>([
  [0x3d66dd9ee36b4240n, async (handler, payload) => {
    try {
      const decoded = decodeString(payload, 0);
      if (decoded.next !== payload.length) throw new Error("args: trailing bytes");
      const message = decoded.value;
      const result = await handler.echo(message);
      return encodeResultOk(encodeString(result));
    } catch (e) {
      return encodeResultErr(encodeInvalidPayload());
    }
  }],
  [0x268246d3219503fbn, async (handler, payload) => {
    try {
      const decoded = decodeString(payload, 0);
      if (decoded.next !== payload.length) throw new Error("args: trailing bytes");
      const message = decoded.value;
      const result = await handler.reverse(message);
      return encodeResultOk(encodeString(result));
    } catch (e) {
      return encodeResultErr(encodeInvalidPayload());
    }
  }],
]);
