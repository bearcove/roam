[package]
name = "roam-shm"
version.workspace = true
edition.workspace = true
license.workspace = true
repository.workspace = true
description = "Shared-memory transport binding implementation"

[package.metadata]

[package.metadata."docs.rs"]
rustdoc-args = ["--html-in-header", "arborium-header.html"]

[features]
default = ["std"]
std = ["shm-primitives/std"]
tokio = ["dep:tokio", "dep:roam-session", "dep:roam-stream"]
tracing = ["dep:tracing"]

[dependencies]
shm-primitives = { path = "../shm-primitives", default-features = false }
roam-frame = { path = "../roam-frame" }
ur-taking-me-with-you = { path = "../ur-taking-me-with-you" }
roam-wire = { path = "../roam-wire" }
roam-session = { path = "../roam-session", optional = true }
roam-stream = { path = "../roam-stream", optional = true }
facet-postcard = { workspace = true }
tokio = { workspace = true, features = ["time", "sync"], optional = true }
tracing = { workspace = true, optional = true }
libc = { workspace = true }

[target.'cfg(target_os = "macos")'.dependencies]
libproc = "0.14"

[dev-dependencies]
shm-primitives = { path = "../shm-primitives", features = ["alloc", "std"] }
tempfile = "3"
libc = { workspace = true }
tokio = { workspace = true, features = ["macros", "rt", "time"] }
roam-session = { path = "../roam-session" }
roam = { path = "../roam" }
tracing-subscriber = { workspace = true }

[[bin]]
name = "guest_process"
path = "tests/support/guest_process_main.rs"
required-features = ["tokio"]
test = false
bench = false
