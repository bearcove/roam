[package]
name = "roam-shm"
version.workspace = true
edition.workspace = true
license.workspace = true
repository.workspace = true
description = "Shared-memory transport binding implementation"

[package.metadata]

[package.metadata."docs.rs"]
rustdoc-args = ["--html-in-header", "arborium-header.html"]

[features]
default = ["tracing"]
tracing = ["dep:tracing", "roam-session/tracing"]
diagnostics = ["roam-session/diagnostics"]

[dependencies]
shm-primitives.workspace = true
roam-frame.workspace = true
ur-taking-me-with-you.workspace = true
roam-wire.workspace = true
roam-session.workspace = true
roam-stream.workspace = true
facet.workspace = true
facet-postcard = { workspace = true }
tokio = { workspace = true, features = ["time", "sync", "net", "io-util"] }
tracing = { workspace = true, optional = true }
libc = { workspace = true }
futures-util.workspace = true

[target.'cfg(target_os = "macos")'.dependencies]
libproc = "0.14"

[target.'cfg(unix)'.dependencies]
roam-fdpass = { path = "../roam-fdpass" }

[dev-dependencies]
shm-primitives.workspace = true
tempfile = "3"
libc = { workspace = true }
tokio = { workspace = true, features = ["macros", "rt", "time"] }
roam-session.workspace = true
roam.workspace = true
roam-tracing.workspace = true
futures = "0.3.31"
facet-testhelpers.workspace = true
facet.workspace = true

[[bin]]
name = "guest_process"
path = "tests/support/guest_process_main.rs"
test = false
bench = false
