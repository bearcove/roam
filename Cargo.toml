[workspace]
resolver = "2"
members = [
    "rust/roam",
    "rust/roam-wire",
    "rust/roam-frame",
    "rust/roam-session",
    "rust/roam-hash",
    "rust/roam-schema",
    "rust/roam-shm",
    "rust/roam-tracing",
    "rust/roam-codegen",
    "rust/roam-macros",
    "rust/roam-macros-parse",
    "rust/roam-stream",
    "rust/roam-local",
    "rust/roam-fdpass",
    "rust/roam-websocket",
    "rust/roam-http-bridge",
    "rust/subject-rust",
    "rust/shm-primitives",
    "rust/ur-taking-me-with-you",
    "rust/roam-task-local",
    "rust/roam-next",
    # Compliance suite
    "spec/spec-proto",
    "spec/spec-tests",
    # xtask
    "xtask",
    # Peer server for TypeScript browser tests
    "typescript/peer-server",
]
exclude = ["fuzz"]

[workspace.package]
version = "0.6.0"
edition = "2024"
rust-version = "1.91"
license = "MIT OR Apache-2.0"
repository = "https://github.com/bearcove/roam"

[workspace.dependencies]
# Internal crates
roam = { path = "rust/roam", version = "0.6.0" }
roam-frame = { path = "rust/roam-frame", version = "0.6.0" }
roam-hash = { path = "rust/roam-hash", version = "0.6.0" }
roam-macros-parse = { path = "rust/roam-macros-parse", version = "0.6.0" }
roam-service-macros = { path = "rust/roam-macros", version = "0.6.0" }
roam-schema = { path = "rust/roam-schema", version = "0.6.0" }
roam-wire = { path = "rust/roam-wire", version = "0.6.0" }
roam-session = { path = "rust/roam-session", version = "0.6.0" }
roam-stream = { path = "rust/roam-stream", version = "0.6.0" }
roam-tracing = { path = "rust/roam-tracing", version = "0.6.0" }
roam-codegen = { path = "rust/roam-codegen", version = "0.6.0" }
roam-websocket = { path = "rust/roam-websocket", version = "0.6.0" }
shm-primitives = { path = "rust/shm-primitives", version = "0.6.0", default-features = false }
ur-taking-me-with-you = { path = "rust/ur-taking-me-with-you", version = "0.6.0" }
roam-task-local = { path = "rust/roam-task-local", version = "0.6.0" }

# External dependencies
bytes = "1"
blake3 = "1.8"
cobs = "0.5.0"
tokio = { version = "1", features = ["sync", "rt", "time", "macros", "io-util"] }
tokio-tungstenite = "0.26"
libc = "0.2.180"

# facet ecosystem
facet = { version = "0.43.0", git = "https://github.com/facet-rs/facet", branch = "main", features = ["camino", "reflect"] }
facet-core = { version = "0.43.0", git = "https://github.com/facet-rs/facet", branch = "main" }
facet-postcard = { version = "0.43.0", git = "https://github.com/facet-rs/facet", branch = "main", features = ["camino"] }
facet-reflect = { version = "0.43.0", git = "https://github.com/facet-rs/facet", branch = "main" }
facet-format = { version = "0.43.0", git = "https://github.com/facet-rs/facet", branch = "main" }
facet-pretty = { version = "0.43.0", git = "https://github.com/facet-rs/facet", branch = "main" }
facet-json = { version = "0.43.0", git = "https://github.com/facet-rs/facet", branch = "main" }
facet-value = { version = "0.43.0", git = "https://github.com/facet-rs/facet", branch = "main" }
facet-testhelpers = { version = "0.43.0", git = "https://github.com/facet-rs/facet", branch = "main" }
facet-cargo-toml = { version = "0.43.0", git = "https://github.com/bearcove/facet-cargo-toml", branch = "main" }

# Futures utilities
futures-util = "0.3"
futures-channel = "0.3"
async-channel = "2.5"

# WASM support
wasm-bindgen-futures = "0.4"
gloo-timers = { version = "0.3", features = ["futures"] }

# Tracing
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }
static_assertions = "1.1.0"

# Test utilities
ctor = "0.4"

[profile.release]
debug = 1
